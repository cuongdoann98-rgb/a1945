<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" />
  <title>Náº¡p Coins TikTok</title>
  <meta name="theme-color" content="#ffffff">
  <link rel="manifest" href="manifest.json">

  <style>
    :root{
      --safe-left: env(safe-area-inset-left, 0px);
      --safe-right: env(safe-area-inset-right, 0px);
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
    }

    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: #ffffff;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      display: flex;
      justify-content: center;
      color: #111;
      -webkit-font-smoothing:antialiased;
      -webkit-text-size-adjust:100%;
      touch-action: pan-y;
    }

    .phone {
      width: 100%;
      max-width: 420px;
      min-height: 100vh;
      box-sizing: border-box;
      position: relative;
      background: transparent;
      overflow: hidden;
    }

    /* Header - Fixed */
    header.ios-header {
      position: fixed;
      left: 0;
      right: 0;
      top: 0;
      background: #fff;
      border-bottom: 1px solid #eee;
      z-index: 1200;
      box-sizing: border-box;
    }
    header.ios-header .header-inner {
      max-width: 420px;
      margin: 0 auto;
      padding: calc(8px + var(--safe-top)) 16px 8px;
      display: grid;
      grid-template-columns: 56px 1fr 56px;
      align-items: center;
      gap: 8px;
      box-sizing: border-box;
    }
    .back-btn {
      display: inline-flex;
      align-items: center;
      justify-content: flex-start;
      width: 56px;
      height: 40px;
      padding-left: 6px;
      border: none;
      background: transparent;
      color: #000;
      font-size: 24px;
      font-weight: 300;
      line-height: 1;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }
    .back-btn:active { opacity: 0.7; }

    .ios-title {
      text-align: center;
      font-size: 18px;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding: 0 6px;
    }

    .more-btn {
      display: inline-flex;
      align-items: center;
      justify-content: flex-end;
      width: 56px;
      height: 40px;
      padding-right: 6px;
      border: none;
      background: transparent;
      color: #333;
      font-size: 22px;
      font-weight: 500;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
    }
    .more-btn:active { opacity: 0.75; }

    /* Main container */
    .main-content { 
      margin-top: 72px;
      height: calc(100vh - 72px);
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    .container {
      margin: 0 auto;
      max-width: 420px;
      width: 100%;
      padding: 20px 16px 220px;
      box-sizing: border-box;
      display:flex;
      flex-direction:column;
      gap:20px;
    }

    /* Balance box */
    .balance-box {
      display:flex;
      align-items:center;
      background:#fff;
      border-radius:12px;
      padding:12px 15px;
      gap:12px;
      border: 1px solid rgba(0,0,0,0.03);
      box-sizing:border-box;
      width:100%;
    }
    .tiktok-logo { width:40px; height:40px; object-fit:contain; }
    .balance-info { display:flex; flex-direction:column; gap:4px; }
    .recharge-text { font-size:18px; font-weight:700; color:#000; }
    .balance-line { display:flex; align-items:center; gap:8px; }
    .coin-icon { width:18px; height:18px; }
    #balanceAmount { font-size:15px; color:#111; border:none; background:transparent; font-size: 16px; }

    /* Recharge section */
    .recharge-section { width:100%; box-sizing:border-box; }
    .recharge-section h3 { margin:0 0 8px 0; font-size:23px; font-weight:700; position: sticky; top: 0; background: white; padding: 10px 0; z-index: 10; }

    .tiktok-input-wrapper {
      display:flex;
      align-items:center;
      border:1.5px solid #d0d0d0;
      border-radius:10px;
      padding:0 10px;
      background:#f9f9f9;
      box-sizing:border-box;
      width:100%;
      transition: border-color 0.2s ease;
      font-size: 16px; /* Prevent zoom on iOS */
    }
    .tiktok-input-wrapper:focus-within {
      border-color: #007AFF;
      background: #fff;
    }
    .tiktok-input-wrapper .at-symbol { margin-right:8px; color:#666; font-size: 16px; }
    .tiktok-input-wrapper input { 
      border:none; 
      outline:none; 
      flex:1; 
      font-size:16px; 
      padding:10px 0; 
      background:transparent; 
      width:100%;
      min-height: 44px; /* Better touch target */
    }

    /* Coins grid */
    .coins-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
      margin-top: 12px;
      box-sizing: border-box;
      width:100%;
    }
    .coin-option {
      background: #e3e3e3;
      border: 1.5px solid #d0d0d0;
      border-radius: 10px;
      padding: 12px 10px;
      text-align: center;
      cursor: pointer;
      transition: 0.18s;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:6px;
      user-select: none;
      box-sizing: border-box;
      width:100%;
    }
    .coin-option:focus { outline: 3px solid rgba(254,44,85,0.12); }
    .coin-option.selected { border-color: #fe2c55; background: #fff2f5; }
    .coin-option.disabled { opacity: 0.45; pointer-events: none; }
    .coin-value { font-weight:600; font-size:18px; display:flex; align-items:center; justify-content:center; gap:6px; }
    .coin-value img { width:18px; height:18px; }
    .coin-price { font-size:13px; color:#777; }

    /* Footer */
    .payment-footer {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      background: #fff;
      border-top: 1px solid #eee;
      box-shadow: 0 -3px 10px rgba(0,0,0,0.06);
      z-index: 1200;
      box-sizing: border-box;
    }
    .payment-footer .footer-inner {
      max-width: 420px;
      margin: 0 auto;
      padding: 12px 16px calc(12px + var(--safe-bottom));
      box-sizing: border-box;
    }
    .payment-logos { display:flex; flex-wrap:wrap; gap:6px; align-self:flex-start; }
    .pay-icon { height:14px; width:auto; object-fit:contain; }
    .total-line { display:flex; justify-content:space-between; width:100%; font-size:15px; color:#333; margin:8px 0; }
    .done-btn {
      width:100%;
      background:#fe2c55;
      color:#fff;
      border:none;
      border-radius:8px;
      padding:13px;
      font-size:16px;
      cursor:pointer;
    }
    .done-btn[disabled] { opacity:0.6; cursor:not-allowed; }

    /* Sheet - Updated to match the image */
    .sheet-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.4); opacity: 0; visibility: hidden; transition: all .25s ease; z-index:1500; }
    .sheet-backdrop.active { opacity: 1; visibility: visible; }
    .sheet { 
      position: fixed; 
      left: 0; 
      right: 0; 
      bottom: -100%; 
      background: #fff; 
      border-top-left-radius:20px; 
      border-top-right-radius:20px; 
      box-shadow: 0 -5px 20px rgba(0,0,0,0.2); 
      transition: bottom .25s ease; 
      z-index:1501;
      height: 70vh;
      display: flex;
      flex-direction: column;
    }
    .sheet.active { bottom: 0; }
    .sheet-header { 
      padding:16px 20px; 
      text-align:center; 
      font-size:18px; 
      font-weight:700; 
      border-bottom:1px solid #eee; 
      position:relative; 
    }
    .sheet-header button { position:absolute; right:20px; top:12px; border:none; background:none; font-size:22px; cursor:pointer; }
    .sheet-body { 
      padding:20px; 
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    .sheet-title-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
    }
    
    .arrow-down {
      width: 0;
      height: 0;
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-top: 5px solid #333;
    }
    
    .custom-display {
      background: #f8f8f8;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      margin-bottom: 20px;
    }
    
    .custom-amount {
      font-size: 32px;
      font-weight: bold;
      color: #000;
      margin: 10px 0;
    }
    
    .custom-price {
      font-size: 24px;
      font-weight: bold;
      color: #fe2c55;
    }
    
    .keypad {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin: 20px 0;
    }
    
    .keypad-btn {
      background: #f0f0f0;
      border: none;
      border-radius: 12px;
      padding: 15px;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .keypad-btn:active {
      background: #e0e0e0;
    }
    
    .special-offer {
      background: #fff2f5;
      border-radius: 12px;
      padding: 15px;
      margin: 15px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .offer-text {
      font-size: 14px;
      color: #fe2c55;
      font-weight: 600;
    }
    
    .offer-arrow {
      color: #fe2c55;
      font-weight: bold;
    }
    
    .sheet-total {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
      border-top: 1px solid #eee;
      margin-top: 10px;
    }
    
    .total-label {
      font-size: 16px;
      font-weight: 600;
    }
    
    .total-value {
      font-size: 20px;
      font-weight: bold;
      color: #fe2c55;
    }

    .visually-hidden { position:absolute !important; height:1px; width:1px; overflow:hidden; clip:rect(1px, 1px, 1px, 1px); white-space:nowrap; }

    @media (max-width: 340px) {
      .coin-value { font-size:16px; }
      .coin-price { font-size:12px; }
    }
  </style>
</head>
<body>
  <div class="phone">
    <header class="ios-header" role="banner">
      <div class="header-inner">
        <button class="back-btn" id="backBtn" aria-label="Trá» láº¡i">&lsaquo;</button>
        <div class="ios-title" id="pageTitle">Get Coins to send Gifts to TikTok</div>
        <button class="more-btn" id="moreBtn" aria-label="ThÃªm tÃ¹y chá»n">â¯</button>
      </div>
    </header>

    <div class="main-content">
      <main class="container" role="main">
        <div class="balance-box" aria-hidden="false">
          <img src="tiktok.png" class="tiktok-logo" alt="TikTok logo">
          <div class="balance-info">
            <span class="recharge-text">Recharge</span>
            <div class="balance-line">
              <img src="coin.png" class="coin-icon" alt="coin icon">
              <input type="text" id="balanceAmount" value="2,506,051" readonly aria-readonly="true" />
            </div>
          </div>
        </div>

        <section class="recharge-section" aria-label="Get Coins section">
          <h3>Get Coins</h3>

          <label for="tiktokId" class="visually-hidden">TikTok username</label>
          <div class="tiktok-input-wrapper">
            <span class="at-symbol" aria-hidden="true">@</span>
            <input type="text" id="tiktokId" placeholder="username" aria-label="TikTok username" autocomplete="username">
          </div>

          <div class="coins-grid" role="list">
            <div class="coin-option" role="button" tabindex="0" data-coins="70" data-price="1.00">
              <div class="coin-value"><img src="coin.png" alt="coin icon">70</div>
              <div class="coin-price">$1.00</div>
            </div>
            <div class="coin-option" role="button" tabindex="0" data-coins="350" data-price="5.00">
              <div class="coin-value"><img src="coin.png" alt="coin icon">350</div>
              <div class="coin-price">$5.00</div>
            </div>
            <div class="coin-option" role="button" tabindex="0" data-coins="700" data-price="9.00">
              <div class="coin-value"><img src="coin.png" alt="coin icon">700</div>
              <div class="coin-price">$9.00</div>
            </div>
            <div class="coin-option" role="button" tabindex="0" data-coins="1700" data-price="19.00">
              <div class="coin-value"><img src="coin.png" alt="coin icon">1,700</div>
              <div class="coin-price">$19.00</div>
            </div>
            <div class="coin-option" role="button" tabindex="0" data-coins="3000" data-price="29.00">
              <div class="coin-value"><img src="coin.png" alt="coin icon">3,000</div>
              <div class="coin-price">$29.00</div>
            </div>
            <div class="coin-option" role="button" tabindex="0" data-coins="7000" data-price="69.00">
              <div class="coin-value"><img src="coin.png" alt="coin icon">7,000</div>
              <div class="coin-price">$69.00</div>
            </div>
            <div class="coin-option" role="button" tabindex="0" data-coins="17500" data-price="199.00">
              <div class="coin-value"><img src="coin.png" alt="coin icon">17,500</div>
              <div class="coin-price">$199.00</div>
            </div>
            <div class="coin-option" id="customOption" role="button" tabindex="0" aria-label="Custom amount">
              <div class="coin-value"><img src="coin.png" alt="coin icon">Custom</div>
            </div>
          </div>
        </section>
      </main>

      <div class="payment-footer" aria-live="polite">
        <div class="footer-inner">
          <div class="payment-logos" aria-hidden="true">
            <img src="visa.png" class="pay-icon" alt="Visa">
            <img src="mastercard.png" class="pay-icon" alt="Mastercard">
            <img src="paypal.png" class="pay-icon" alt="PayPal">
            <img src="applepay.png" class="pay-icon" alt="Apple Pay">
            <img src="googlepay.png" class="pay-icon" alt="Google Pay">
            <img src="zalopay.png" class="pay-icon" alt="ZaloPay">
            <img src="momo.png" class="pay-icon" alt="MoMo">
            <img src="vnpay.png" class="pay-icon" alt="VNPay">
          </div>

          <div class="total-line"><span>Total:</span><span id="totalAmount">$0.00</span></div>
          <button class="done-btn" id="rechargeBtn" type="button" disabled>Recharge</button>
        </div>
      </div>
    </div>

    <!-- Custom sheet - Updated to match the image -->
    <div class="sheet-backdrop" id="sheetBackdrop" aria-hidden="true"></div>
    <div class="sheet" id="customSheet" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="customTitle">
      <div class="sheet-header">
        <div id="customTitle">Custom</div>
        <button id="closeSheet" type="button" aria-label="Close">&times;</button>
      </div>
      <div class="sheet-body">
        <div class="sheet-title-row">
          <div class="arrow-down"></div>
          <h4 style="margin:0;">Number of Coins</h4>
        </div>
        
        <div class="custom-display">
          <div class="custom-amount" id="customDisplayAmount">2,000,000</div>
          <div class="custom-price" id="customDisplayPrice">â«649,193,800</div>
        </div>
        
        <div class="keypad">
          <button class="keypad-btn" data-key="1">1</button>
          <button class="keypad-btn" data-key="2">2</button>
          <button class="keypad-btn" data-key="3">3</button>
          <button class="keypad-btn" data-key="4">4</button>
          <button class="keypad-btn" data-key="5">5</button>
          <button class="keypad-btn" data-key="6">6</button>
          <button class="keypad-btn" data-key="7">7</button>
          <button class="keypad-btn" data-key="8">8</button>
          <button class="keypad-btn" data-key="9">9</button>
          <button class="keypad-btn" style="visibility: hidden;"></button>
          <button class="keypad-btn" data-key="0">0</button>
          <button class="keypad-btn" id="backspaceBtn">â«</button>
        </div>
        
        <div class="special-offer">
          <span class="offer-text">Special offer</span>
          <span class="offer-arrow">></span>
        </div>
        
        <div class="special-offer">
          <span class="offer-text">Unlock 5% cashback</span>
          <span class="offer-arrow">></span>
        </div>
        
        <div class="sheet-total">
          <span class="total-label">Total</span>
          <span class="total-value" id="sheetTotalAmount">â«649,193,800</span>
        </div>
        
        <button class="done-btn" id="confirmCustom" type="button">Recharge</button>
      </div>
    </div>

  </div>

  <script>
    // DOM refs
    const coinOptions = Array.from(document.querySelectorAll('.coin-option'));
    const customOption = document.getElementById('customOption');
    const totalAmountEl = document.getElementById('totalAmount');
    const sheet = document.getElementById('customSheet');
    const sheetBackdrop = document.getElementById('sheetBackdrop');
    const closeSheet = document.getElementById('closeSheet');
    const confirmCustom = document.getElementById('confirmCustom');
    const rechargeBtn = document.getElementById('rechargeBtn');
    const tiktokIdInput = document.getElementById('tiktokId');
    const balanceInput = document.getElementById('balanceAmount');
    
    // Custom sheet elements
    const customDisplayAmount = document.getElementById('customDisplayAmount');
    const customDisplayPrice = document.getElementById('customDisplayPrice');
    const sheetTotalAmount = document.getElementById('sheetTotalAmount');
    const keypadBtns = document.querySelectorAll('.keypad-btn');
    const backspaceBtn = document.getElementById('backspaceBtn');

    const backBtn = document.getElementById('backBtn');
    const moreBtn = document.getElementById('moreBtn');

    let selectedCoins = 0;
    let selectedPrice = 0;
    let coinOptionsDisabled = false;
    const STORAGE_KEY = 'recharge_balance';
    
    // Custom amount state
    let customAmount = 2000000; // Default 2,000,000

    // default rate
    const firstPriced = coinOptions.find(o => o.dataset.coins && o.dataset.price);
    const DEFAULT_RATE = (firstPriced && parseInt(firstPriced.dataset.coins, 10) > 0)
      ? (parseFloat(firstPriced.dataset.price) / parseInt(firstPriced.dataset.coins, 10))
      : (1.0 / 70);

    // VND rate (approximate)
    const VND_RATE = 324.5969; // $1 = ~324.6 VND

    // formatting helpers
    function formatNumberWithCommas(n) {
      if (n === null || n === undefined) return '';
      if (!isFinite(n)) return String(n);
      return Number(n).toLocaleString('en-US');
    }

    function formatVND(amount) {
      return 'â«' + formatNumberWithCommas(Math.round(amount));
    }

    function parseIntFromFormatted(str) {
      if (!str) return NaN;
      const digits = String(str).replace(/,/g, '').replace(/\s/g, '');
      const integerPart = digits.split('.')[0];
      return parseInt(integerPart, 10);
    }

    // Update custom display
    function updateCustomDisplay() {
      const coins = customAmount;
      const priceUSD = coins * DEFAULT_RATE;
      const priceVND = priceUSD * VND_RATE;
      
      customDisplayAmount.textContent = formatNumberWithCommas(coins);
      customDisplayPrice.textContent = formatVND(priceVND);
      sheetTotalAmount.textContent = formatVND(priceVND);
    }

    // Handle keypad input
    function handleKeypadInput(key) {
      if (key === 'â«') {
        // Backspace - remove last digit
        customAmount = Math.floor(customAmount / 10);
      } else {
        // Number input - append digit
        const digit = parseInt(key, 10);
        customAmount = customAmount * 10 + digit;
        
        // Limit to reasonable number
        if (customAmount > 1000000000) {
          customAmount = 1000000000;
        }
      }
      
      updateCustomDisplay();
    }

    // load/save balance persistent
    function loadBalance() {
      try {
        const stored = localStorage.getItem(STORAGE_KEY);
        if (stored !== null) {
          const num = Number(stored);
          if (!Number.isNaN(num)) {
            balanceInput.value = formatNumberWithCommas(num);
            return;
          }
        }
        const raw = (balanceInput.value || '').toString().replace(/,/g, '');
        const num = Number(raw) || 0;
        localStorage.setItem(STORAGE_KEY, String(num));
        balanceInput.value = formatNumberWithCommas(num);
      } catch (e) {
        try {
          const raw = (balanceInput.value || '').toString().replace(/,/g, '');
          const num = Number(raw) || 0;
          balanceInput.value = formatNumberWithCommas(num);
        } catch {}
      }
    }

    function saveBalance(num) {
      try {
        localStorage.setItem(STORAGE_KEY, String(Number(num) || 0));
      } catch (e) {}
    }

    function addCoinsToBalance(coinsToAdd) {
      try {
        const raw = (balanceInput.value || '').toString().replace(/,/g, '');
        const current = Number(raw) || 0;
        const next = current + Number(coinsToAdd || 0);
        balanceInput.value = formatNumberWithCommas(next);
        saveBalance(next);
      } catch (e) {}
    }

    function setCoinOptionsDisabled(disabled) {
      coinOptionsDisabled = !!disabled;
      coinOptions.forEach(o => {
        if (coinOptionsDisabled) {
          o.classList.add('disabled');
          o.setAttribute('aria-disabled', 'true');
        } else {
          o.classList.remove('disabled');
          o.removeAttribute('aria-disabled');
        }
      });
    }

    // sheet open/close
    const openSheet = () => {
      if (coinOptionsDisabled) return;
      sheet.classList.add('active');
      sheetBackdrop.classList.add('active');
      sheet.setAttribute('aria-hidden', 'false');
      sheetBackdrop.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
      
      // Reset to default amount
      customAmount = 2000000;
      updateCustomDisplay();
    };

    const closePopup = () => {
      sheet.classList.remove('active');
      sheetBackdrop.classList.remove('active');
      sheet.setAttribute('aria-hidden', 'true');
      sheetBackdrop.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
      const focused = document.querySelector('.coin-option.selected') || document.querySelector('.coin-option');
      if (focused) focused.focus();
    };

    function updateRechargeState() {
      const hasUser = tiktokIdInput.value.trim().length > 0;
      const hasSelection = selectedCoins > 0 && selectedPrice > 0;
      rechargeBtn.disabled = !(hasUser && hasSelection);
    }

    // option handlers
    coinOptions.forEach(option => {
      function selectOption() {
        if (coinOptionsDisabled) return;
        coinOptions.forEach(o => o.classList.remove('selected'));
        if (option.id === 'customOption') {
          openSheet();
        } else {
          option.classList.add('selected');
          const coins = parseInt(option.dataset.coins, 10);
          const price = parseFloat(option.dataset.price);
          selectedCoins = Number.isFinite(coins) ? coins : 0;
          selectedPrice = Number.isFinite(price) ? price : 0;
          totalAmountEl.textContent = '$' + selectedPrice.toFixed(2);
          updateRechargeState();
        }
      }
      option.addEventListener('click', selectOption);
      option.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          selectOption();
        }
      });
    });

    // Keypad event listeners
    keypadBtns.forEach(btn => {
      if (btn.dataset.key || btn.id === 'backspaceBtn') {
        btn.addEventListener('click', () => {
          const key = btn.dataset.key || 'â«';
          handleKeypadInput(key);
        });
      }
    });

    // Event listeners
    closeSheet.addEventListener('click', closePopup);
    sheetBackdrop.addEventListener('click', closePopup);

    confirmCustom.addEventListener('click', () => {
      if (customAmount > 0) {
        selectedCoins = customAmount;
        selectedPrice = customAmount * DEFAULT_RATE;
        totalAmountEl.textContent = '$' + selectedPrice.toFixed(2);
        updateRechargeState();
        closePopup();
        
        // Clear selection from other options
        coinOptions.forEach(o => o.classList.remove('selected'));
      }
    });

    tiktokIdInput.addEventListener('input', updateRechargeState);

    rechargeBtn.addEventListener('click', () => {
      if (rechargeBtn.disabled) return;
      
      // Simulate recharge process
      setCoinOptionsDisabled(true);
      rechargeBtn.textContent = 'Processing...';
      
      setTimeout(() => {
        addCoinsToBalance(selectedCoins);
        alert(`Successfully recharged ${formatNumberWithCommas(selectedCoins)} coins for $${selectedPrice.toFixed(2)}!`);
        
        // Reset UI
        selectedCoins = 0;
        selectedPrice = 0;
        totalAmountEl.textContent = '$0.00';
        coinOptions.forEach(o => o.classList.remove('selected'));
        setCoinOptionsDisabled(false);
        rechargeBtn.textContent = 'Recharge';
        updateRechargeState();
      }, 1500);
    });

    backBtn.addEventListener('click', () => {
      if (confirm('Are you sure you want to go back? Any unsaved changes will be lost.')) {
        window.history.back();
      }
    });

    moreBtn.addEventListener('click', () => {
      alert('More options menu would open here');
    });

    // Prevent zoom on input focus
    tiktokIdInput.addEventListener('focus', () => {
      setTimeout(() => {
        document.documentElement.style.zoom = "1";
      }, 100);
    });

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      loadBalance();
      updateRechargeState();
      updateCustomDisplay();
    });

    // Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js').catch(err => {
        console.warn('Service worker registration failed:', err);
      });
    }
  </script>
</body>
</html>